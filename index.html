<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>æ²ç¤ºæ¿ | Board</title>
  <link rel="stylesheet" href="style/base.css" />
  <link rel="stylesheet" href="style/board-modern.css" />
  <style>
    /* è¦–è¦šçš„ã«ã¯éè¡¨ç¤ºã ãŒã‚¹ã‚¯ãƒªãƒ¼ãƒ³ãƒªãƒ¼ãƒ€ãƒ¼ã§èª­ã¾ã›ãŸã„è¦‹å‡ºã—ç”¨ */
    .visually-hidden {
      position: absolute !important;
      width: 1px; height: 1px;
      padding: 0; margin: -1px;
      overflow: hidden; clip: rect(0 0 0 0);
      white-space: nowrap; border: 0;
    }
  </style>
</head>
<body>
  <!-- ===== ã‚¢ã‚¯ã‚»ã‚¹ã‚¬ãƒ¼ãƒ‰ï¼šæœªãƒ­ã‚°ã‚¤ãƒ³/æœªæ‰¿èªãªã‚‰ãƒ­ã‚°ã‚¤ãƒ³ã¸ ===== -->
  <script>
    (function(){
      const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
      const me = JSON.parse(localStorage.getItem('currentUser') || '{}');
      const approved = JSON.parse(localStorage.getItem('approvedUsers') || '[]');
      const approvedOk = approved.some(u => u.email === me.email);
      if (!isLoggedIn || !me.email || !approvedOk) {
        location.href = 'login.html';
      }
    })();
  </script>

  <!-- ã‚µã‚¤ãƒˆå…¨ä½“ã®ãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆãƒŠãƒ“å«ã‚€ï¼‰ -->
  <header class="header" role="banner">
    <h1>æ²ç¤ºæ¿</h1>
    <nav aria-label="ã‚¢ã‚«ã‚¦ãƒ³ãƒˆé–¢é€£">
      <a id="profileLink" href="profile.html"></a>
      <button id="logoutBtn" class="btn">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</button>
    </nav>
  </header>

  <!-- ãƒ¡ã‚¤ãƒ³é ˜åŸŸï¼šæŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ  + æŠ•ç¨¿ä¸€è¦§ -->
  <main id="main" role="main">
    <!-- æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ ã‚¨ãƒªã‚¢ -->
    <section id="post-section" class="form-area" aria-labelledby="post-section-title">
      <h2 id="post-section-title" class="visually-hidden">æ–°è¦æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ </h2>

      <!-- â€» JSï¼ˆmain.jsï¼‰ãŒã“ã®IDã‚’ä½¿ã£ã¦ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã—ã¾ã™ -->
      <form id="postForm" aria-describedby="post-form-desc">
        <p id="post-form-desc" class="visually-hidden">åå‰ã€é¡Œåã€æœ¬æ–‡ã‚’å…¥åŠ›ã—ã¦æŠ•ç¨¿ã§ãã¾ã™ã€‚</p>

        <label for="name" class="visually-hidden">åå‰</label>
        <input id="name" name="name" type="text" placeholder="Name" autocomplete="nickname" required />

        <label for="subject" class="visually-hidden">é¡Œå</label>
        <input id="subject" name="subject" type="text" placeholder="Subject" autocomplete="off" />

        <label for="body" class="visually-hidden">æœ¬æ–‡</label>
        <textarea id="body" name="body" placeholder="æœ¬æ–‡ã‚’å…¥åŠ›..." rows="5" aria-multiline="true"></textarea>

        <div class="form-actions">
          <button type="submit" aria-label="æŠ•ç¨¿ã™ã‚‹">æŠ•ç¨¿</button>
        </div>
      </form>
    </section>

    <!-- æŠ•ç¨¿ä¸€è¦§ã‚¨ãƒªã‚¢ -->
    <section id="posts-section" class="posts" aria-labelledby="posts-section-title">
      <h2 id="posts-section-title" class="visually-hidden">æŠ•ç¨¿ä¸€è¦§</h2>
      <!-- JS ãŒã“ã“ã¸ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã—ã¾ã™ -->
      <div id="postsContainer"></div>
    </section>
  </main>

  <!-- ãƒ•ãƒƒã‚¿ãƒ¼ï¼šãƒãƒ¼ã‚¸ãƒ§ãƒ³ãªã©ä»»æ„ã®æƒ…å ±ã‚’ç½®ãã¨é‹ç”¨æ™‚ã«ä¾¿åˆ© -->
  <footer class="footer" role="contentinfo">
    <p>Â© æ²ç¤ºæ¿2025 | Ver 0.9 Beta</p>
  </footer>

  <!-- JSï¼šdefer ã§æç”»ãƒ–ãƒ­ãƒƒã‚¯å›é¿ã€‚authâ†’main ã®é †ï¼ˆä¾å­˜ã®éƒ½åˆï¼‰ -->
  <script defer src="script/auth.js"></script>
  <script defer src="script/main.js"></script>

  <!-- ãƒ˜ãƒƒãƒ€ãƒ¼ã®ãƒ—ãƒ­ãƒ•ã‚£ãƒ¼ãƒ«è¡¨ç¤º/ãƒ­ã‚°ã‚¢ã‚¦ãƒˆåˆ¶å¾¡ï¼ˆDOMç”Ÿæˆå¾Œã«å®Ÿè¡Œï¼‰ -->
  <script>
  document.addEventListener('DOMContentLoaded', () => {
    const me = JSON.parse(localStorage.getItem('currentUser') || '{}');
    const a = document.getElementById('profileLink');
    const out = document.getElementById('logoutBtn');

    if (!a || !out) return;

    // ãƒ­ã‚°ã‚¤ãƒ³ä¸­ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå­˜åœ¨ã™ã‚‹å ´åˆã®è¡¨ç¤º
    if (me && me.name) {
      a.textContent = `ğŸ‘¤ ${me.name}ï¼ˆãƒ­ã‚°ã‚¤ãƒ³ä¸­ï¼‰`;
      a.href = 'profile.html';
      out.style.display = '';
    } else {
      // æœªãƒ­ã‚°ã‚¤ãƒ³æ™‚ã®è¡¨ç¤º
      a.textContent = 'ãƒ­ã‚°ã‚¤ãƒ³';
      a.href = 'login.html';
      out.style.display = 'none';
    }

    // ãƒ­ã‚°ã‚¢ã‚¦ãƒˆãƒœã‚¿ãƒ³å‹•ä½œ
    out.addEventListener('click', () => {
      localStorage.removeItem('isLoggedIn');
      localStorage.removeItem('currentUser');
      location.href = 'login.html';
    });

    // æŠ•ç¨¿ãƒ•ã‚©ãƒ¼ãƒ ã®è‡ªå‹•è£œå®Œ
    const nameInput = document.getElementById('name');
    if (nameInput && me && me.name) {
      nameInput.value = me.name;
    }
  });
  </script>

  <!-- JSãŒç„¡åŠ¹ãªç’°å¢ƒã§ã®ã‚¬ãƒ¼ãƒ‰ -->
  <noscript>ã“ã®ã‚¢ãƒ—ãƒªã‚’åˆ©ç”¨ã™ã‚‹ã«ã¯JavaScriptã‚’æœ‰åŠ¹ã«ã—ã¦ãã ã•ã„ã€‚</noscript>
</body>
</html>
